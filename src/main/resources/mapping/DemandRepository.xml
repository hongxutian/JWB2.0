<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- mapper 为根元素节点， 一个namespace对应一个repo -->
<mapper namespace="com.hnu.repository.DemandRepository">

<!--  查询语句  -->
    <select id="findByRange" parameterType="com.hnu.entity.newest.Limit" resultType="com.hnu.entity.Demand">
       select u.nick_name, u.avatar_url, d.* from medical_resources_userinfo u, medical_resources_demand d where d.s_lon &lt;= #{maxLon}
       and d.s_lon &gt;= #{minLon} and d.s_lat &lt;= #{maxLat} and d.s_lat &gt;= #{minLat}
       and d.s_subtime &gt;= #{startTime} and d.s_subtime &lt;= #{endTime} and d.u_id_id = u.id
       order by d.s_subtime DESC
       limit #{start},#{limit};

    </select>

    <insert id="insertDemand" parameterType="com.hnu.entity.Demand" useGeneratedKeys="true" keyProperty="id">

        insert into medical_resources_demand(s_lon,s_lat,s_nation,s_city,s_province,s_district,
        s_street,s_street_number,s_content,s_type,s_range,s_aging,s_subtime,store_name,u_id_id,demand_id)
        values (
        #{s_lon},#{s_lat},#{s_nation},#{s_city},#{s_province},#{s_district},#{s_street},#{s_street_number},#{s_content},#{s_type},
        #{s_range},#{s_aging},#{s_subtime},#{store_name},#{u_id_id},#{demand_id}
        );

    </insert>

    <select id="searchStores" resultType="com.hnu.entity.Demand">
        select
        *
        from medical_resources_demand
        where s_type='1' and store_name like #{keyword} limit #{current_position},#{page_items_count};
    </select>

</mapper>